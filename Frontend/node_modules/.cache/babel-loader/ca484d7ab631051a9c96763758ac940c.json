{"ast":null,"code":"import _regeneratorRuntime from\"/Users/thunderchawla/Documents/GitHub/Backend/server/Frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/thunderchawla/Documents/GitHub/Backend/server/Frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/thunderchawla/Documents/GitHub/Backend/server/Frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from\"axios\";import React from\"react\";import{useState}from\"react\";import{useLocation,useNavigate,useSearchParams}from\"react-router-dom\";import Cookies from\"universal-cookie\";import{MainNavbar}from\"./User/MainNavbar\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export function Login(){var _useSearchParams=useSearchParams(),_useSearchParams2=_slicedToArray(_useSearchParams,1),searchParams=_useSearchParams2[0];var cookie=new Cookies();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var navigate=useNavigate();var useQuery=function useQuery(){var _useLocation=useLocation(),search=_useLocation.search;return React.useMemo(function(){return new URLSearchParams(search);},[search]);};var query=useQuery();var queryEmail=query.get(\"email\");//remove query from url\nif(email===\"\"&&queryEmail!==null){setEmail(queryEmail);// document.getElementById(\"email\").innerHTML = queryEmail;\n}var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var userName;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// e.preventDefault();\nuserName=\"\";_context.next=3;return axios.get(\"http://localhost:3001/user/username/\"+email).then(function(res){console.log(res.data);if(res.data===\"\"){alert(\"User does not exist\");}else{userName=res.data;}}).catch(function(err){console.log(err);});case 3:console.log(email,password);axios.post(\"http://localhost:3001/login/\",{email:email,password:password,token:\"TOKEN\"}).then(function(res){if(res.data.msg===\"success\"){console.log(\"success\");cookie.set(\"sessionToken\",res.data.cookie,{path:'/'});cookie.set(\"username\",userName,{path:'/'});window.location.href=\"/\"+userName;}else{//console.log(name, res.data.password);\nconsole.log(res);console.log(\"error\");}}).catch(function(err){console.log(err);});case 5:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(){return _ref.apply(this,arguments);};}();function setEmailFromQuery(target){target.value=queryEmail;}return/*#__PURE__*/_jsxs(\"div\",{className:\"Login\",children:[/*#__PURE__*/_jsx(MainNavbar,{active:'Login'}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"App-header\"}),/*#__PURE__*/_jsx(\"div\",{className:\"App-body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"Input-Container\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email:\"}),email!==\"\"?/*#__PURE__*/_jsx(\"input\",{value:email,name:\"mail\",type:'text',placeholder:\"Enter your email\",onChange:function onChange(event){return setEmail(event.target.value);},maxLength:100}):/*#__PURE__*/_jsx(\"input\",{name:\"mail\",type:'text',placeholder:\"Enter your email\",onChange:function onChange(event){return setEmail(event.target.value);},maxLength:100}),/*#__PURE__*/_jsx(\"label\",{children:\"Password:\"}),/*#__PURE__*/_jsx(\"input\",{type:'password',placeholder:'Enter your password',onChange:function onChange(event){return setPassword(event.target.value);}}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,children:\"Submit\"})]})})]});}","map":{"version":3,"names":["axios","React","useState","useLocation","useNavigate","useSearchParams","Cookies","MainNavbar","Login","searchParams","cookie","email","setEmail","password","setPassword","navigate","useQuery","search","useMemo","URLSearchParams","query","queryEmail","get","handleSubmit","userName","then","res","console","log","data","alert","catch","err","post","token","msg","set","path","window","location","href","setEmailFromQuery","target","value","event"],"sources":["/Users/thunderchawla/Documents/GitHub/Backend/server/Frontend/src/Login.js"],"sourcesContent":["import axios from \"axios\";\nimport React from \"react\";\n\nimport {useState} from \"react\";\nimport {useLocation, useNavigate, useSearchParams} from \"react-router-dom\";\nimport Cookies from \"universal-cookie\";\nimport {MainNavbar} from \"./User/MainNavbar\";\n\n\nexport function Login() {\n    const [searchParams] = useSearchParams();\n    const cookie = new Cookies();\n\n    const [email, setEmail] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    let navigate = useNavigate();\n\n    const useQuery = () => {\n        const { search } = useLocation();\n\n        return React.useMemo(() => new URLSearchParams(search), [search]);\n    }\n    \n    const query = useQuery();\n   \n    const queryEmail = query.get(\"email\");\n    //remove query from url\n    if(email === \"\"&& queryEmail !== null) {\n        setEmail(queryEmail);\n        // document.getElementById(\"email\").innerHTML = queryEmail;\n    }\n    \n\n\n\n    const handleSubmit = async () => {\n         // e.preventDefault();\n        var userName = \"\";\n        await axios.get(\"http://localhost:3001/user/username/\" + email).then(res => {\n            console.log(res.data);\n            if(res.data === \"\") {\n                alert(\"User does not exist\");\n            } else {\n                userName = res.data;\n            }\n        }).catch(err => {\n            console.log(err);\n        });\n\n        console.log(email, password);\n        axios.post(\"http://localhost:3001/login/\", {\n            email: email,\n            password: password,\n            token: \"TOKEN\",\n            }).then(res => {\n            if(res.data.msg === \"success\") {\n                console.log(\"success\");\n                cookie.set(\"sessionToken\", res.data.cookie, { path: '/' });\n                cookie.set(\"username\", userName, { path: '/' });\n                window.location.href = (\"/\" +  userName);\n\n            }\n            else \n            {\n                //console.log(name, res.data.password);\n                console.log(res);\n                console.log(\"error\");\n            }\n        }).catch(err => {\n            console.log(err);\n        });\n\n\n    };\n\n    function setEmailFromQuery(target) {\n        target.value = queryEmail;\n    }\n\n    return (\n        <div className=\"Login\">\n            <MainNavbar active={'Login'}/>\n            <br />\n            <br />\n            <br />\n            <div className=\"App-header\">\n            </div>\n            <div className=\"App-body\">\n                <div className=\"Input-Container\">\n                    <label>Email:</label>\n                    {\n                        email !== \"\"\n                            ? <input value={email} name={\"mail\"} type={'text'} placeholder={\"Enter your email\"}\n                                   onChange={(event) => setEmail(event.target.value)} maxLength={100}/>\n                            : <input  name={\"mail\"} type={'text'} placeholder={\"Enter your email\"}\n                            onChange={(event) => setEmail(event.target.value)} maxLength={100}/>\n                    }\n                            <label>Password:</label>\n                            <input type={'password'} placeholder={'Enter your password'}\n                                   onChange={(event) => setPassword(event.target.value)}/>\n                            <button onClick={handleSubmit}>Submit</button>\n                        </div>\n                    \n            </div>\n        </div>\n    );\n}"],"mappings":"ycAAA,MAAOA,MAAP,KAAkB,OAAlB,CACA,MAAOC,MAAP,KAAkB,OAAlB,CAEA,OAAQC,QAAR,KAAuB,OAAvB,CACA,OAAQC,WAAR,CAAqBC,WAArB,CAAkCC,eAAlC,KAAwD,kBAAxD,CACA,MAAOC,QAAP,KAAoB,kBAApB,CACA,OAAQC,UAAR,KAAyB,mBAAzB,C,wFAGA,MAAO,SAASC,MAAT,EAAiB,CACpB,qBAAuBH,eAAe,EAAtC,sDAAOI,YAAP,sBACA,GAAMC,OAAM,CAAG,GAAIJ,QAAJ,EAAf,CAEA,cAA0BJ,QAAQ,CAAC,EAAD,CAAlC,wCAAOS,KAAP,eAAcC,QAAd,eACA,eAAgCV,QAAQ,CAAC,EAAD,CAAxC,yCAAOW,QAAP,eAAiBC,WAAjB,eACA,GAAIC,SAAQ,CAAGX,WAAW,EAA1B,CAEA,GAAMY,SAAQ,CAAG,QAAXA,SAAW,EAAM,CACnB,iBAAmBb,WAAW,EAA9B,CAAQc,MAAR,cAAQA,MAAR,CAEA,MAAOhB,MAAK,CAACiB,OAAN,CAAc,iBAAM,IAAIC,gBAAJ,CAAoBF,MAApB,CAAN,EAAd,CAAiD,CAACA,MAAD,CAAjD,CAAP,CACH,CAJD,CAMA,GAAMG,MAAK,CAAGJ,QAAQ,EAAtB,CAEA,GAAMK,WAAU,CAAGD,KAAK,CAACE,GAAN,CAAU,OAAV,CAAnB,CACA;AACA,GAAGX,KAAK,GAAK,EAAV,EAAeU,UAAU,GAAK,IAAjC,CAAuC,CACnCT,QAAQ,CAACS,UAAD,CAAR,CACA;AACH,CAKD,GAAME,aAAY,4FAAG,kJAChB;AACGC,QAFa,CAEF,EAFE,uBAGXxB,MAAK,CAACsB,GAAN,CAAU,uCAAyCX,KAAnD,EAA0Dc,IAA1D,CAA+D,SAAAC,GAAG,CAAI,CACxEC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,IAAhB,EACA,GAAGH,GAAG,CAACG,IAAJ,GAAa,EAAhB,CAAoB,CAChBC,KAAK,CAAC,qBAAD,CAAL,CACH,CAFD,IAEO,CACHN,QAAQ,CAAGE,GAAG,CAACG,IAAf,CACH,CACJ,CAPK,EAOHE,KAPG,CAOG,SAAAC,GAAG,CAAI,CACZL,OAAO,CAACC,GAAR,CAAYI,GAAZ,EACH,CATK,CAHW,QAcjBL,OAAO,CAACC,GAAR,CAAYjB,KAAZ,CAAmBE,QAAnB,EACAb,KAAK,CAACiC,IAAN,CAAW,8BAAX,CAA2C,CACvCtB,KAAK,CAAEA,KADgC,CAEvCE,QAAQ,CAAEA,QAF6B,CAGvCqB,KAAK,CAAE,OAHgC,CAA3C,EAIOT,IAJP,CAIY,SAAAC,GAAG,CAAI,CACf,GAAGA,GAAG,CAACG,IAAJ,CAASM,GAAT,GAAiB,SAApB,CAA+B,CAC3BR,OAAO,CAACC,GAAR,CAAY,SAAZ,EACAlB,MAAM,CAAC0B,GAAP,CAAW,cAAX,CAA2BV,GAAG,CAACG,IAAJ,CAASnB,MAApC,CAA4C,CAAE2B,IAAI,CAAE,GAAR,CAA5C,EACA3B,MAAM,CAAC0B,GAAP,CAAW,UAAX,CAAuBZ,QAAvB,CAAiC,CAAEa,IAAI,CAAE,GAAR,CAAjC,EACAC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAwB,IAAOhB,QAA/B,CAEH,CAND,IAQA,CACI;AACAG,OAAO,CAACC,GAAR,CAAYF,GAAZ,EACAC,OAAO,CAACC,GAAR,CAAY,OAAZ,EACH,CACJ,CAlBD,EAkBGG,KAlBH,CAkBS,SAAAC,GAAG,CAAI,CACZL,OAAO,CAACC,GAAR,CAAYI,GAAZ,EACH,CApBD,EAfiB,sDAAH,kBAAZT,aAAY,0CAAlB,CAwCA,QAASkB,kBAAT,CAA2BC,MAA3B,CAAmC,CAC/BA,MAAM,CAACC,KAAP,CAAetB,UAAf,CACH,CAED,mBACI,aAAK,SAAS,CAAC,OAAf,wBACI,KAAC,UAAD,EAAY,MAAM,CAAE,OAApB,EADJ,cAEI,aAFJ,cAGI,aAHJ,cAII,aAJJ,cAKI,YAAK,SAAS,CAAC,YAAf,EALJ,cAOI,YAAK,SAAS,CAAC,UAAf,uBACI,aAAK,SAAS,CAAC,iBAAf,wBACI,iCADJ,CAGQV,KAAK,GAAK,EAAV,cACM,cAAO,KAAK,CAAEA,KAAd,CAAqB,IAAI,CAAE,MAA3B,CAAmC,IAAI,CAAE,MAAzC,CAAiD,WAAW,CAAE,kBAA9D,CACK,QAAQ,CAAE,kBAACiC,KAAD,QAAWhC,SAAQ,CAACgC,KAAK,CAACF,MAAN,CAAaC,KAAd,CAAnB,EADf,CACwD,SAAS,CAAE,GADnE,EADN,cAGM,cAAQ,IAAI,CAAE,MAAd,CAAsB,IAAI,CAAE,MAA5B,CAAoC,WAAW,CAAE,kBAAjD,CACF,QAAQ,CAAE,kBAACC,KAAD,QAAWhC,SAAQ,CAACgC,KAAK,CAACF,MAAN,CAAaC,KAAd,CAAnB,EADR,CACiD,SAAS,CAAE,GAD5D,EANd,cASY,oCATZ,cAUY,cAAO,IAAI,CAAE,UAAb,CAAyB,WAAW,CAAE,qBAAtC,CACO,QAAQ,CAAE,kBAACC,KAAD,QAAW9B,YAAW,CAAC8B,KAAK,CAACF,MAAN,CAAaC,KAAd,CAAtB,EADjB,EAVZ,cAYY,eAAQ,OAAO,CAAEpB,YAAjB,oBAZZ,GADJ,EAPJ,GADJ,CA2BH"},"metadata":{},"sourceType":"module"}